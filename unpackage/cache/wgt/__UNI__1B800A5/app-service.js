if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((l=>t.resolve(e()).then((()=>l))),(l=>t.resolve(e()).then((()=>{throw l}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...l){uni.__log__?uni.__log__(e,t,...l):console[e].apply(console,[...l,t])}function l(e,t){return"string"==typeof e?t:e}const n={pulldown:"",refreshempty:"",back:"",forward:"",more:"","more-filled":"",scan:"",qq:"",weibo:"",weixin:"",pengyouquan:"",loop:"",refresh:"","refresh-filled":"",arrowthindown:"",arrowthinleft:"",arrowthinright:"",arrowthinup:"","undo-filled":"",undo:"",redo:"","redo-filled":"",bars:"",chatboxes:"",camera:"","chatboxes-filled":"","camera-filled":"","cart-filled":"",cart:"","checkbox-filled":"",checkbox:"",arrowleft:"",arrowdown:"",arrowright:"","smallcircle-filled":"",arrowup:"",circle:"","eye-filled":"","eye-slash-filled":"","eye-slash":"",eye:"","flag-filled":"",flag:"","gear-filled":"",reload:"",gear:"","hand-thumbsdown-filled":"","hand-thumbsdown":"","hand-thumbsup-filled":"","heart-filled":"","hand-thumbsup":"",heart:"",home:"",info:"","home-filled":"","info-filled":"","circle-filled":"","chat-filled":"",chat:"","mail-open-filled":"","email-filled":"","mail-open":"",email:"",checkmarkempty:"",list:"","locked-filled":"",locked:"","map-filled":"","map-pin":"","map-pin-ellipse":"",map:"","minus-filled":"","mic-filled":"",minus:"",micoff:"",mic:"",clear:"",smallcircle:"",close:"",closeempty:"",paperclip:"",paperplane:"","paperplane-filled":"","person-filled":"","contact-filled":"",person:"",contact:"","images-filled":"",phone:"",images:"",image:"","image-filled":"","location-filled":"",location:"","plus-filled":"",plus:"",plusempty:"","help-filled":"",help:"","navigate-filled":"",navigate:"","mic-slash-filled":"",search:"",settings:"",sound:"","sound-filled":"","spinner-cycle":"","download-filled":"","personadd-filled":"","videocam-filled":"",personadd:"",upload:"","upload-filled":"",starhalf:"","star-filled":"",star:"",trash:"","phone-filled":"",compose:"",videocam:"","trash-filled":"",download:"","chatbubble-filled":"",chatbubble:"","cloud-download":"","cloud-upload-filled":"","cloud-upload":"","cloud-download-filled":"",headphones:"",shop:""},i=(e,t)=>{const l=e.__vccOpts||e;for(const[n,i]of t)l[n]=i;return l};const a=i({name:"UniIcons",props:{type:{type:String,default:""},color:{type:String,default:"#333333"},size:{type:[Number,String],default:16},customIcons:{type:String,default:""}},data:()=>({icons:n}),methods:{_onClick(){this.$emit("click")}}},[["render",function(t,l,n,i,a,o){return e.openBlock(),e.createElementBlock("text",{style:e.normalizeStyle({color:n.color,"font-size":n.size+"px"}),class:e.normalizeClass(["uni-icons",[n.customIcons,n.customIcons?n.type:""]]),onClick:l[0]||(l[0]=(...e)=>o._onClick&&o._onClick(...e))},e.toDisplayString(a.icons[n.type]),7)}],["__scopeId","data-v-c72a3ace"]]);const o=i({name:"UniCollapseItem",components:{uniIcons:a},props:{title:{type:String,default:""},name:{type:[Number,String],default:0},disabled:{type:Boolean,default:!1},showAnimation:{type:Boolean,default:!1},open:{type:Boolean,default:!1},thumb:{type:String,default:""}},data:()=>({isOpen:!1}),watch:{open(e){this.isOpen=e}},inject:["collapse"],created(){if(this.isOpen=this.open,this.nameSync=this.name?this.name:this.collapse.childrens.length,this.collapse.childrens.push(this),"true"===String(this.collapse.accordion)&&this.isOpen){this.collapse.childrens[this.collapse.childrens.length-2]&&(this.collapse.childrens[this.collapse.childrens.length-2].isOpen=!1)}},methods:{onClick(){this.disabled||("true"===String(this.collapse.accordion)&&this.collapse.childrens.forEach((e=>{e!==this&&(e.isOpen=!1)})),this.isOpen=!this.isOpen,this.collapse.onChange&&this.collapse.onChange(),this.$forceUpdate())}}},[["render",function(t,n,i,o,r,s){const c=l(e.resolveDynamicComponent("uni-icons"),a);return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass([{"uni-collapse-cell--disabled":i.disabled,"uni-collapse-cell--notdisabled":!i.disabled,"uni-collapse-cell--open":r.isOpen,"uni-collapse-cell--hide":!r.isOpen},"uni-collapse-cell"])},[e.createElementVNode("view",{class:"uni-collapse-cell__title",onClick:n[0]||(n[0]=(...e)=>s.onClick&&s.onClick(...e))},[i.thumb?(e.openBlock(),e.createElementBlock("image",{key:0,src:i.thumb,class:"uni-collapse-cell__title-img"},null,8,["src"])):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"uni-collapse-cell__title-text"},e.toDisplayString(i.title),1),e.createVNode(c,{class:e.normalizeClass([{"uni-collapse-cell__title-arrow-active":r.isOpen,"uni-collapse-cell--animation":!0===i.showAnimation},"uni-collapse-cell__title-arrow"]),color:"#bbb",size:"20",type:"arrowdown"},null,8,["class"])]),e.createElementVNode("view",{class:e.normalizeClass([{"uni-collapse-cell__content--hide":!r.isOpen},"uni-collapse-cell__content"])},[e.createElementVNode("view",{class:e.normalizeClass([{"uni-collapse-cell--animation":!0===i.showAnimation},"uni-collapse-cell__wrapper"]),style:e.normalizeStyle({transform:r.isOpen?"translateY(0)":"translateY(-50%)","-webkit-transform":r.isOpen?"translateY(0)":"translateY(-50%)"})},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)],2)],2)}],["__scopeId","data-v-a69461b2"]]);const r=i({name:"UniCollapse",props:{accordion:{type:[Boolean,String],default:!1}},data:()=>({}),provide(){return{collapse:this}},created(){this.childrens=[]},methods:{onChange(){let e=[];this.childrens.forEach(((t,l)=>{t.isOpen&&e.push(t.nameSync)})),this.$emit("change",e)}}},[["render",function(t,l,n,i,a,o){return e.openBlock(),e.createElementBlock("view",{class:"uni-collapse"},[e.renderSlot(t.$slots,"default",{},void 0,!0)])}],["__scopeId","data-v-02bdb246"]]),s=e.ref([]),c=e.ref([]);var d=e.ref("http://localhost:5173"),u=e.ref("未找到"),p=e.ref(""),h=e.ref(""),f=e.ref(""),m=e.ref(""),v=e.ref("_ _");function g(e){const l=e.deviceId;uni.createBLEConnection({deviceId:l,success:l=>(t("log","at pages/index/index.vue:212",l),uni.showToast({title:"连接成功",icon:"success",duration:800}),p.value=e.deviceId,!0),fail:e=>(uni.showToast({title:"连接失败",type:"error",icon:"none"}),t("log","at pages/index/index.vue:227",e),!1)})}function y(e){if(""==p.value)for(var l=0;l<e.devices.length;l++){var n=e.devices[l];if(""!=n.name&&(t("log","at pages/index/index.vue:242",n.name),"Soul_Translator"==n.name&&(t("log","at pages/index/index.vue:244","找到目标"),u.value="找到目标",uni.stopBeaconDiscovery(),s.value.push(n),g(n))))break}}uni.setNavigationBarTitle({title:"Soul_Translator"});__definePage("pages/index/index",i({data:()=>({responce_text:v,bluetoothlist:s,servicelist:c,url:d,found_text:u,notifyUuid:f,cuurent_service:h,writeUuid:m}),onReady(){},onLoad(){},methods:{test_request:function(){uni.request({url:"https://open.bigmodel.cn/api/paas/v4/chat/completions",data:{model:"GLM-4-0520",messages:[{role:"user",content:"请用中文简洁使下面的单词组成句子并表达自然，无需添加任何额外的信息或评论，保持回复的简洁和直接：I am boy"}]},header:{Authorization:"Bearer 0ed2bef9cc03d071f5833d883693eb71.ErbGECCEmtlB85J8"},method:"POST",success:e=>{t("log","at pages/index/index.vue:103",e.data);var l=e.data.choices,n=l[0];t("log","at pages/index/index.vue:108",n=l[0].message.content),v.value=n}})},initBlue:function(){uni.openBluetoothAdapter({success(e){uni.showToast({title:"初始化蓝牙成功",icon:"success",duration:800}),t("log","at pages/index/index.vue:172","初始化蓝牙成功"),t("log","at pages/index/index.vue:173",e)},fail(e){uni.showToast({title:"请打开蓝牙",type:"error",icon:"none"}),t("log","at pages/index/index.vue:181","初始化蓝牙失败"),t("error","at pages/index/index.vue:182",e)}})},discovery:function(){p.value="",s.value=[],uni.startBluetoothDevicesDiscovery({success(e){t("log","at pages/index/index.vue:192","开始搜索"),uni.showLoading({title:"正在搜索设备"}),uni.onBluetoothDeviceFound(y)},fail(e){t("log","at pages/index/index.vue:200","搜索失败"),t("error","at pages/index/index.vue:201",e)}})},getservices:function(){""==p.value&&uni.showToast({title:"请先连接蓝牙",type:"error",icon:"none"}),uni.getBLEDeviceServices({deviceId:p.value,success:function(e){t("log","at pages/index/index.vue:127",e);for(var l=0;l<e.services.length;l++)c.value.push(e.services[l]),t("log","at pages/index/index.vue:130",c)}})},getCharacteId:function(e){t("log","at pages/index/index.vue:137",e),uni.getBLEDeviceCharacteristics({deviceId:p.value,serviceId:e,success:function(l){t("log","at pages/index/index.vue:144",l);for(var n=0;n<l.characteristics.length;n++){var i=l.characteristics[n];i.properties.write&&(h.value=e,m.value=i.uuid),i.properties.notify&&(h.value=e,f.value=i.uuid)}}})},startNotice:function(){uni.notifyBLECharacteristicValueChange({state:!0,deviceId:p.value,serviceId:h.value,characteristicId:f.value,success(e){uni.onBLECharacteristicValueChange((e=>{var l;t("log","at pages/index/index.vue:334",`characteristic ${e.characteristicId} has changed, now is ${e.value}`),t("log","at pages/index/index.vue:335",function(e){let l,n=e.trim(),i="0x"===n.substr(0,2).toLowerCase()?n.substr(2):n,a=i.length;if(a%2!=0)return t("log","at pages/index/index.vue:291","Illegal Format ASCII Code!"),"";let o=[];for(let t=0;t<a;t+=2)l=parseInt(i.substr(t,2),16),o.push(String.fromCharCode(l));return o.join("")}((l=e.value,Array.prototype.map.call(new Uint8Array(l),(function(e){return("00"+e.toString(16)).slice(-2)})).join(""))))}))},fail(e){t("log","at pages/index/index.vue:339",e)}})},write:function(e){var l=function(e){let t="";for(let l=0;l<e.length;l++)""===t?t=e.charCodeAt(l).toString(16):t+=","+e.charCodeAt(l).toString(16);return new Uint8Array(t.match(/[\da-f]{2}/gi).map((function(e){return parseInt(e,16)}))).buffer}(e);uni.writeBLECharacteristicValue({deviceId:p.value,serviceId:h.value,characteristicId:m.value,value:l,success:function(e){t("log","at pages/index/index.vue:359","写入成功")},fail:function(e){t("log","at pages/index/index.vue:362",e)},complete:function(){t("log","at pages/index/index.vue:365","调用结束")}})}}},[["render",function(t,n,i,a,s,c){const d=l(e.resolveDynamicComponent("uni-collapse-item"),o),u=l(e.resolveDynamicComponent("uni-collapse"),r);return e.openBlock(),e.createElementBlock("view",{class:"content"},[e.createElementVNode("view",{class:"text-area"},[e.createElementVNode("view",{style:{width:"100%"}},[e.createElementVNode("view",{style:{display:"flex","justify-content":"center","margin-top":"50%"}},[e.createElementVNode("view",{class:"text-box","scroll-y":"true"},[e.createElementVNode("text",{style:{"font-size":"30px"}},e.toDisplayString(s.responce_text),1)])]),e.createElementVNode("button",{onClick:n[0]||(n[0]=(...e)=>c.test_request&&c.test_request(...e)),style:{"margin-top":"10px"}},"测试接口")]),e.createVNode(u,{ref:"collapse",modelValue:t.value,"onUpdate:modelValue":n[6]||(n[6]=e=>t.value=e)},{default:e.withCtx((()=>[e.createVNode(d,{title:"测试"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",null,[e.createElementVNode("div",null,e.toDisplayString(s.found_text),1),e.createElementVNode("div",null,"服务:"+e.toDisplayString(s.cuurent_service),1),e.createElementVNode("div",null,"监听:"+e.toDisplayString(s.notifyUuid),1),e.createElementVNode("div",null,"发送:"+e.toDisplayString(s.writeUuid),1)]),e.createElementVNode("button",{onClick:n[1]||(n[1]=(...e)=>c.initBlue&&c.initBlue(...e))},"初始化蓝牙"),e.createElementVNode("button",{onClick:n[2]||(n[2]=(...e)=>c.discovery&&c.discovery(...e))},"搜索"),e.createElementVNode("scroll-view",{"scroll-y":"",class:"box"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.bluetoothlist,(t=>(e.openBlock(),e.createElementBlock("view",{class:"item"},[e.createElementVNode("view",null,[e.createElementVNode("text",null,"id: "+e.toDisplayString(t.deviceId),1)]),e.createElementVNode("view",null,[e.createElementVNode("text",null,"name: "+e.toDisplayString(t.name),1)])])))),256))]),e.createElementVNode("button",{onClick:n[3]||(n[3]=(...e)=>c.getservices&&c.getservices(...e))},"搜索服务"),e.createElementVNode("scroll-view",{"scroll-y":"",class:"box"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.servicelist,(t=>(e.openBlock(),e.createElementBlock("view",{class:"item"},[e.createElementVNode("view",null,[e.createElementVNode("button",{onClick:e=>c.getCharacteId(t.uuid)},"uuid: "+e.toDisplayString(t.uuid),9,["onClick"])])])))),256))]),e.createElementVNode("button",{onClick:n[4]||(n[4]=(...e)=>c.startNotice&&c.startNotice(...e))},"监听服务"),e.createElementVNode("button",{onClick:n[5]||(n[5]=e=>c.write("abcd"))},"发消息")])])),_:1})])),_:1},8,["modelValue"])])])}]]));const x={onLaunch:function(){t("log","at App.vue:4","App Launch")},onShow:function(){t("log","at App.vue:7","App Show")},onHide:function(){t("log","at App.vue:10","App Hide")}};const{app:w,Vuex:b,Pinia:_}={app:e.createVueApp(x)};uni.Vuex=b,uni.Pinia=_,w.provide("__globalStyles",__uniConfig.styles),w._component.mpType="app",w._component.render=()=>{},w.mount("#app")}(Vue);
